{"ast":null,"code":"import React,{useEffect,useState}from'react';import{Typography,Button,IconButton,Box,Grid,Card,CardMedia,CardActions,CircularProgress}from'@mui/material';import DeleteIcon from'@mui/icons-material/Delete';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE_URL=\"http://localhost:8000/api\";function OrphanedImages(_ref){let{token}=_ref;const[orphanedImages,setOrphanedImages]=useState([]);const[loading,setLoading]=useState(false);const[errorMsg,setErrorMsg]=useState('');useEffect(()=>{loadOrphanedImages();},[]);const loadOrphanedImages=async()=>{setLoading(true);setErrorMsg('');try{const response=await axios.get(\"\".concat(API_BASE_URL,\"/errors/images/orphaned/\"),{headers:{Authorization:\"Bearer \".concat(token)}});setOrphanedImages(response.data);}catch(err){setErrorMsg(\"\\u041E\\u0448\\u0438\\u0431\\u043A\\u0430 \\u043F\\u0440\\u0438 \\u0437\\u0430\\u0433\\u0440\\u0443\\u0437\\u043A\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0439: \".concat(err.message));}finally{setLoading(false);}};const handleDeleteImage=async imageId=>{if(!window.confirm('Вы уверены, что хотите удалить это изображение?'))return;try{await axios.delete(\"\".concat(API_BASE_URL,\"/errors/images/\").concat(imageId),{headers:{Authorization:\"Bearer \".concat(token)}});// Remove the deleted image from the state\nsetOrphanedImages(orphanedImages.filter(img=>img.id!==imageId));}catch(err){alert('Ошибка при удалении изображения');}};return/*#__PURE__*/_jsxs(Box,{sx:{width:'100%',maxWidth:1200,margin:'auto',mt:4,p:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,sx:{color:'#f2a365'},children:\"\\u0418\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F \\u0431\\u0435\\u0437 \\u043F\\u0440\\u0438\\u0432\\u044F\\u0437\\u043A\\u0438 \\u043A \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430\\u043C\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",sx:{color:'#eaeaea',mb:3},children:\"\\u0417\\u0434\\u0435\\u0441\\u044C \\u043E\\u0442\\u043E\\u0431\\u0440\\u0430\\u0436\\u0430\\u044E\\u0442\\u0441\\u044F \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F, \\u043A\\u043E\\u0442\\u043E\\u0440\\u044B\\u0435 \\u043D\\u0435 \\u043F\\u0440\\u0438\\u0432\\u044F\\u0437\\u0430\\u043D\\u044B \\u043D\\u0438 \\u043A \\u043E\\u0434\\u043D\\u043E\\u0439 \\u043E\\u0448\\u0438\\u0431\\u043A\\u0435. \\u0412\\u044B \\u043C\\u043E\\u0436\\u0435\\u0442\\u0435 \\u0443\\u0434\\u0430\\u043B\\u0438\\u0442\\u044C \\u043D\\u0435\\u043D\\u0443\\u0436\\u043D\\u044B\\u0435 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u044F.\"}),errorMsg&&/*#__PURE__*/_jsx(Typography,{sx:{mb:2,whiteSpace:'pre-wrap',color:'#ff6b6b',fontWeight:'700'},children:errorMsg}),loading?/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'center',mt:4},children:/*#__PURE__*/_jsx(CircularProgress,{sx:{color:'#f2a365'}})}):/*#__PURE__*/_jsx(_Fragment,{children:orphanedImages.length===0?/*#__PURE__*/_jsx(Typography,{sx:{color:'#eaeaea',textAlign:'center',mt:4},children:\"\\u041D\\u0435\\u0442 \\u0438\\u0437\\u043E\\u0431\\u0440\\u0430\\u0436\\u0435\\u043D\\u0438\\u0439 \\u0431\\u0435\\u0437 \\u043F\\u0440\\u0438\\u0432\\u044F\\u0437\\u043A\\u0438 \\u043A \\u043E\\u0448\\u0438\\u0431\\u043A\\u0430\\u043C\"}):/*#__PURE__*/_jsx(Grid,{container:true,spacing:3,children:orphanedImages.map(img=>/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:4,lg:3,children:/*#__PURE__*/_jsxs(Card,{sx:{backgroundColor:'#2a2f4a',color:'#eaeaea'},children:[/*#__PURE__*/_jsx(CardMedia,{component:\"img\",height:\"200\",image:\"\".concat(API_BASE_URL.replace('/api','')).concat(img.image_url),alt:\"Orphaned image \".concat(img.id),sx:{objectFit:'contain'}}),/*#__PURE__*/_jsx(CardActions,{sx:{justifyContent:'center'},children:/*#__PURE__*/_jsx(IconButton,{\"aria-label\":\"delete\",onClick:()=>handleDeleteImage(img.id),sx:{color:'#f2a365','&:hover':{backgroundColor:'rgba(242, 163, 101, 0.1)'}},children:/*#__PURE__*/_jsx(DeleteIcon,{})})})]})},img.id))})})]});}export default OrphanedImages;","map":{"version":3,"names":["React","useEffect","useState","Typography","Button","IconButton","Box","Grid","Card","CardMedia","CardActions","CircularProgress","DeleteIcon","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE_URL","OrphanedImages","_ref","token","orphanedImages","setOrphanedImages","loading","setLoading","errorMsg","setErrorMsg","loadOrphanedImages","response","get","concat","headers","Authorization","data","err","message","handleDeleteImage","imageId","window","confirm","delete","filter","img","id","alert","sx","width","maxWidth","margin","mt","p","children","variant","gutterBottom","color","mb","whiteSpace","fontWeight","display","justifyContent","length","textAlign","container","spacing","map","item","xs","sm","md","lg","backgroundColor","component","height","image","replace","image_url","alt","objectFit","onClick"],"sources":["/app/src/components/OrphanedImages.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport {\r\n  Typography,\r\n  Button,\r\n  IconButton,\r\n  Box,\r\n  Grid,\r\n  Card,\r\n  CardMedia,\r\n  CardActions,\r\n  CircularProgress,\r\n} from '@mui/material';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\nimport axios from 'axios';\r\n\r\nconst API_BASE_URL = `http://localhost:8000/api`;\r\n\r\nfunction OrphanedImages({ token }) {\r\n  const [orphanedImages, setOrphanedImages] = useState([]);\r\n  const [loading, setLoading] = useState(false);\r\n  const [errorMsg, setErrorMsg] = useState('');\r\n\r\n  useEffect(() => {\r\n    loadOrphanedImages();\r\n  }, []);\r\n\r\n  const loadOrphanedImages = async () => {\r\n    setLoading(true);\r\n    setErrorMsg('');\r\n    try {\r\n      const response = await axios.get(`${API_BASE_URL}/errors/images/orphaned/`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      setOrphanedImages(response.data);\r\n    } catch (err) {\r\n      setErrorMsg(`Ошибка при загрузке изображений: ${err.message}`);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  const handleDeleteImage = async (imageId) => {\r\n    if (!window.confirm('Вы уверены, что хотите удалить это изображение?')) return;\r\n    try {\r\n      await axios.delete(`${API_BASE_URL}/errors/images/${imageId}`, {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      // Remove the deleted image from the state\r\n      setOrphanedImages(orphanedImages.filter(img => img.id !== imageId));\r\n    } catch (err) {\r\n      alert('Ошибка при удалении изображения');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Box sx={{ width: '100%', maxWidth: 1200, margin: 'auto', mt: 4, p: 2 }}>\r\n      <Typography variant=\"h4\" gutterBottom sx={{ color: '#f2a365' }}>\r\n        Изображения без привязки к ошибкам\r\n      </Typography>\r\n      <Typography variant=\"body1\" sx={{ color: '#eaeaea', mb: 3 }}>\r\n        Здесь отображаются изображения, которые не привязаны ни к одной ошибке. Вы можете удалить ненужные изображения.\r\n      </Typography>\r\n      \r\n      {errorMsg && (\r\n        <Typography\r\n          sx={{\r\n            mb: 2,\r\n            whiteSpace: 'pre-wrap',\r\n            color: '#ff6b6b',\r\n            fontWeight: '700',\r\n          }}\r\n        >\r\n          {errorMsg}\r\n        </Typography>\r\n      )}\r\n      \r\n      {loading ? (\r\n        <Box sx={{ display: 'flex', justifyContent: 'center', mt: 4 }}>\r\n          <CircularProgress sx={{ color: '#f2a365' }} />\r\n        </Box>\r\n      ) : (\r\n        <>\r\n          {orphanedImages.length === 0 ? (\r\n            <Typography sx={{ color: '#eaeaea', textAlign: 'center', mt: 4 }}>\r\n              Нет изображений без привязки к ошибкам\r\n            </Typography>\r\n          ) : (\r\n            <Grid container spacing={3}>\r\n              {orphanedImages.map((img) => (\r\n                <Grid item xs={12} sm={6} md={4} lg={3} key={img.id}>\r\n                  <Card sx={{ backgroundColor: '#2a2f4a', color: '#eaeaea' }}>\r\n                    <CardMedia\r\n                      component=\"img\"\r\n                      height=\"200\"\r\n                      image={`${API_BASE_URL.replace('/api', '')}${img.image_url}`}\r\n                      alt={`Orphaned image ${img.id}`}\r\n                      sx={{ objectFit: 'contain' }}\r\n                    />\r\n                    <CardActions sx={{ justifyContent: 'center' }}>\r\n                      <IconButton\r\n                        aria-label=\"delete\"\r\n                        onClick={() => handleDeleteImage(img.id)}\r\n                        sx={{ \r\n                          color: '#f2a365',\r\n                          '&:hover': { backgroundColor: 'rgba(242, 163, 101, 0.1)' }\r\n                        }}\r\n                      >\r\n                        <DeleteIcon />\r\n                      </IconButton>\r\n                    </CardActions>\r\n                  </Card>\r\n                </Grid>\r\n              ))}\r\n            </Grid>\r\n          )}\r\n        </>\r\n      )}\r\n    </Box>\r\n  );\r\n}\r\n\r\nexport default OrphanedImages;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}