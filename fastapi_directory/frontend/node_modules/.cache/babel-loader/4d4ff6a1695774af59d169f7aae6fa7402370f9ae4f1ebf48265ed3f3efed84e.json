{"ast":null,"code":"import React,{useState}from\"react\";import{BrowserRouter as Router,Routes,Route}from\"react-router-dom\";import ErrorsList from\"./components/ErrorsList\";import AuthPage from\"./components/AuthPage\";import HeaderMenu from\"./components/HeaderMenu\";import AdminPanelErrors from\"./components/AdminPanelErrors\";import AdminPanelContactInfo from\"./components/AdminPanelContactInfo\";// Assuming AdminPanelLogs and Users components exist or will be created\nimport AdminPanelLogs from\"./components/AdminPanelLogs\";import Users from\"./components/Users\";import{Box}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[userRole,setUserRole]=useState(null);const[userName,setUserName]=useState(null);const[isAdmin,setIsAdmin]=useState(false);const[isSuperAdmin,setIsSuperAdmin]=useState(false);const[showAuth,setShowAuth]=useState(false);const token=localStorage.getItem(\"access_token\");const fetchUserInfo=async token=>{try{const response=await fetch(\"/api/users/me/basic\",{headers:{Authorization:\"Bearer \".concat(token)}});if(response.ok){var _data$role;const data=await response.json();setUserRole(((_data$role=data.role)===null||_data$role===void 0?void 0:_data$role.name)||null);setUserName(data.realname||null);setIsAdmin(data.is_admin||false);setIsSuperAdmin(data.is_super_admin||false);}else{setUserRole(null);setUserName(null);setIsAdmin(false);setIsSuperAdmin(false);}}catch(error){setUserRole(null);setUserName(null);setIsAdmin(false);setIsSuperAdmin(false);}};const handleLoginSuccess=function(token){let name=arguments.length>1&&arguments[1]!==undefined?arguments[1]:\"Admin User\";localStorage.setItem(\"access_token\",token);setUserName(name);fetchUserInfo(token);setShowAuth(false);};const handleLogout=()=>{setUserRole(null);setUserName(null);setIsAdmin(false);setIsSuperAdmin(false);localStorage.removeItem(\"access_token\");};React.useEffect(()=>{if(token){fetchUserInfo(token);}},[token]);return/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsx(HeaderMenu,{userRole:userRole,isAdmin:isAdmin,isSuperAdmin:isSuperAdmin,onLoginClick:()=>setShowAuth(true)}),showAuth?/*#__PURE__*/_jsx(AuthPage,{onLoginSuccess:handleLoginSuccess,onContinueAsGuest:()=>setShowAuth(false)}):/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(ErrorsList,{})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/errors\",element:/*#__PURE__*/_jsx(AdminPanelErrors,{token:token})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/logs\",element:/*#__PURE__*/_jsx(AdminPanelLogs,{token:token})}),/*#__PURE__*/_jsx(Route,{path:\"/users\",element:/*#__PURE__*/_jsx(Users,{token:token})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminPanelErrors,{token:token})}),/*#__PURE__*/_jsx(Route,{path:\"/admin/contactinfo\",element:/*#__PURE__*/_jsx(AdminPanelContactInfo,{token:token})})]}),userRole&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:handleLogout,style:{position:\"fixed\",top:10,right:10},children:\"\\u0412\\u044B\\u0439\\u0442\\u0438\"}),/*#__PURE__*/_jsx(\"footer\",{style:{position:\"fixed\",bottom:10,right:10,backgroundColor:\"#f0f0f0\",padding:\"5px 10px\",borderRadius:\"5px\",boxShadow:\"0 0 5px rgba(0,0,0,0.2)\",fontSize:\"14px\",color:\"#333\"},children:userName})]})]});}export default App;","map":{"version":3,"names":["React","useState","BrowserRouter","Router","Routes","Route","ErrorsList","AuthPage","HeaderMenu","AdminPanelErrors","AdminPanelContactInfo","AdminPanelLogs","Users","Box","jsx","_jsx","jsxs","_jsxs","App","userRole","setUserRole","userName","setUserName","isAdmin","setIsAdmin","isSuperAdmin","setIsSuperAdmin","showAuth","setShowAuth","token","localStorage","getItem","fetchUserInfo","response","fetch","headers","Authorization","concat","ok","_data$role","data","json","role","name","realname","is_admin","is_super_admin","error","handleLoginSuccess","arguments","length","undefined","setItem","handleLogout","removeItem","useEffect","children","onLoginClick","onLoginSuccess","onContinueAsGuest","path","element","onClick","style","position","top","right","bottom","backgroundColor","padding","borderRadius","boxShadow","fontSize","color"],"sources":["/app/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { BrowserRouter as Router, Routes, Route } from \"react-router-dom\";\r\nimport ErrorsList from \"./components/ErrorsList\";\r\nimport AuthPage from \"./components/AuthPage\";\r\nimport HeaderMenu from \"./components/HeaderMenu\";\r\nimport AdminPanelErrors from \"./components/AdminPanelErrors\";\r\nimport AdminPanelContactInfo from \"./components/AdminPanelContactInfo\";\r\n// Assuming AdminPanelLogs and Users components exist or will be created\r\nimport AdminPanelLogs from \"./components/AdminPanelLogs\";\r\nimport Users from \"./components/Users\";\r\nimport { Box } from '@mui/material';\r\n\r\n\r\nfunction App() {\r\n  const [userRole, setUserRole] = useState(null);\r\n  const [userName, setUserName] = useState(null);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [isSuperAdmin, setIsSuperAdmin] = useState(false);\r\n  const [showAuth, setShowAuth] = useState(false);\r\n\r\n  const token = localStorage.getItem(\"access_token\");\r\n\r\n  const fetchUserInfo = async (token) => {\r\n    try {\r\n      const response = await fetch(\"/api/users/me/basic\", {\r\n        headers: { Authorization: `Bearer ${token}` },\r\n      });\r\n      if (response.ok) {\r\n        const data = await response.json();\r\n        setUserRole(data.role?.name || null);\r\n        setUserName(data.realname || null);\r\n        setIsAdmin(data.is_admin || false);\r\n        setIsSuperAdmin(data.is_super_admin || false);\r\n      } else {\r\n        setUserRole(null);\r\n        setUserName(null);\r\n        setIsAdmin(false);\r\n        setIsSuperAdmin(false);\r\n      }\r\n    } catch (error) {\r\n      setUserRole(null);\r\n      setUserName(null);\r\n      setIsAdmin(false);\r\n      setIsSuperAdmin(false);\r\n    }\r\n  };\r\n\r\n  const handleLoginSuccess = (token, name = \"Admin User\") => {\r\n    localStorage.setItem(\"access_token\", token);\r\n    setUserName(name);\r\n    fetchUserInfo(token);\r\n    setShowAuth(false);\r\n  };\r\n\r\n  const handleLogout = () => {\r\n    setUserRole(null);\r\n    setUserName(null);\r\n    setIsAdmin(false);\r\n    setIsSuperAdmin(false);\r\n    localStorage.removeItem(\"access_token\");\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (token) {\r\n      fetchUserInfo(token);\r\n    }\r\n  }, [token]);\r\n\r\n  return (\r\n    <Router>\r\n      <HeaderMenu userRole={userRole} isAdmin={isAdmin} isSuperAdmin={isSuperAdmin} onLoginClick={() => setShowAuth(true)} />\r\n      {showAuth ? (\r\n        <AuthPage\r\n          onLoginSuccess={handleLoginSuccess}\r\n          onContinueAsGuest={() => setShowAuth(false)}\r\n        />\r\n      ) : (\r\n        <Routes>\r\n          <Route path=\"/\" element={<ErrorsList />} />\r\n          <Route path=\"/admin/errors\" element={<AdminPanelErrors token={token} />} />\r\n          <Route path=\"/admin/logs\" element={<AdminPanelLogs token={token} />} />\r\n          <Route path=\"/users\" element={<Users token={token} />} />\r\n          <Route path=\"/admin\" element={<AdminPanelErrors token={token} />} />\r\n          {/* Добавьте другие маршруты по необходимости */}\r\n          <Route path=\"/admin/contactinfo\" element={<AdminPanelContactInfo token={token} />} />\r\n        </Routes>\r\n      )}\r\n      {userRole && (\r\n        <div>\r\n          <button onClick={handleLogout} style={{ position: \"fixed\", top: 10, right: 10 }}>\r\n            Выйти\r\n          </button>\r\n          <footer\r\n            style={{\r\n              position: \"fixed\",\r\n              bottom: 10,\r\n              right: 10,\r\n              backgroundColor: \"#f0f0f0\",\r\n              padding: \"5px 10px\",\r\n              borderRadius: \"5px\",\r\n              boxShadow: \"0 0 5px rgba(0,0,0,0.2)\",\r\n              fontSize: \"14px\",\r\n              color: \"#333\"\r\n            }}\r\n          >\r\n            {userName}\r\n          </footer>\r\n        </div>\r\n      )}\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}