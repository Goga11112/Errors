{"ast":null,"code":"const API_BASE_URL = \"http://localhost:8000/api\";\nfunction getAuthHeaders() {\n  const token = localStorage.getItem(\"access_token\");\n  console.log(\"Access token from localStorage:\", token);\n  if (!token) {\n    throw new Error(\"No access token found, please login\");\n  }\n  return {\n    Authorization: `Bearer ${token}`\n  };\n}\nexport async function fetchUsers() {\n  const response = await fetch(`${API_BASE_URL}/users/`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch users\");\n  }\n  return await response.json();\n}\nexport async function createUser(userData) {\n  const response = await fetch(`${API_BASE_URL}/users/`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(userData)\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to create user\");\n  }\n  return await response.json();\n}\nexport async function fetchErrors() {\n  const response = await fetch(`${API_BASE_URL}/errors/`, {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch errors\");\n  }\n  return await response.json();\n}\nexport async function deleteUser(userId) {\n  const response = await fetch(`${API_BASE_URL}/users/${userId}`, {\n    method: \"DELETE\",\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to delete user\");\n  }\n  return true;\n}\nexport async function updateUserRole(userId, newRoleId) {\n  const response = await fetch(`${API_BASE_URL}/users/${userId}/role`, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify({\n      role_id: newRoleId\n    })\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to update user role\");\n  }\n  return await response.json();\n}\nexport async function createError(errorData) {\n  // Отправляем данные как FormData с local_kw\n  const url = new URL(`${API_BASE_URL}/errors/`);\n  const formData = new FormData();\n  formData.append(\"name\", errorData.name);\n  if (errorData.description) {\n    formData.append(\"description\", errorData.description);\n  }\n  if (errorData.solution_description) {\n    formData.append(\"solution_description\", errorData.solution_description);\n  }\n  if (errorData.files && errorData.files.length > 0) {\n    errorData.files.forEach(file => {\n      formData.append(\"files\", file);\n    });\n  }\n  const response = await fetch(url.toString(), {\n    method: \"POST\",\n    headers: {\n      ...getAuthHeaders()\n    },\n    body: formData\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to create error\");\n  }\n  return await response.json();\n}\nexport async function updateError(errorId, errorData) {\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}`, {\n    method: \"PUT\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n      ...getAuthHeaders()\n    },\n    body: JSON.stringify(errorData)\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to update error\");\n  }\n  return await response.json();\n}\nexport async function deleteError(errorId) {\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}`, {\n    method: \"DELETE\",\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to delete error\");\n  }\n  return true;\n}\nexport async function uploadErrorImage(errorId, file) {\n  const formData = new FormData();\n  formData.append(\"file\", file);\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}/images/`, {\n    method: \"POST\",\n    headers: {\n      ...getAuthHeaders()\n    },\n    body: formData\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to upload error image\");\n  }\n  return await response.json();\n}\n\n// New function to fetch contact infos with local_kw=1\nexport async function fetchContactInfos() {\n  const url = new URL(`${API_BASE_URL}/contact_info/`);\n  url.searchParams.append(\"local_kw\", \"1\");\n  const response = await fetch(url.toString(), {\n    headers: {\n      ...getAuthHeaders()\n    }\n  });\n  if (!response.ok) {\n    throw new Error(\"Failed to fetch contact infos\");\n  }\n  return await response.json();\n}\n\n// Add more API client functions as needed for other endpoints","map":{"version":3,"names":["API_BASE_URL","getAuthHeaders","token","localStorage","getItem","console","log","Error","Authorization","fetchUsers","response","fetch","headers","ok","json","createUser","userData","method","body","JSON","stringify","fetchErrors","deleteUser","userId","updateUserRole","newRoleId","role_id","createError","errorData","url","URL","formData","FormData","append","name","description","solution_description","files","length","forEach","file","toString","updateError","errorId","deleteError","uploadErrorImage","fetchContactInfos","searchParams"],"sources":["F:/Progect/Errors/fastapi_directory/frontend/src/apiClient.js"],"sourcesContent":["const API_BASE_URL = \"http://localhost:8000/api\";\r\n\r\nfunction getAuthHeaders() {\r\n  const token = localStorage.getItem(\"access_token\");\r\n  console.log(\"Access token from localStorage:\", token);\r\n  if (!token) {\r\n    throw new Error(\"No access token found, please login\");\r\n  }\r\n  return { Authorization: `Bearer ${token}` };\r\n}\r\n\r\nexport async function fetchUsers() {\r\n  const response = await fetch(`${API_BASE_URL}/users/`, {\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to fetch users\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function createUser(userData) {\r\n  const response = await fetch(`${API_BASE_URL}/users/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify(userData),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to create user\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function fetchErrors() {\r\n  const response = await fetch(`${API_BASE_URL}/errors/`, {\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to fetch errors\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function deleteUser(userId) {\r\n  const response = await fetch(`${API_BASE_URL}/users/${userId}`, {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to delete user\");\r\n  }\r\n  return true;\r\n}\r\n\r\nexport async function updateUserRole(userId, newRoleId) {\r\n  const response = await fetch(`${API_BASE_URL}/users/${userId}/role`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify({ role_id: newRoleId }),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to update user role\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function createError(errorData) {\r\n  // Отправляем данные как FormData с local_kw\r\n  const url = new URL(`${API_BASE_URL}/errors/`);\r\n\r\n  const formData = new FormData();\r\n  formData.append(\"name\", errorData.name);\r\n  if (errorData.description) {\r\n    formData.append(\"description\", errorData.description);\r\n  }\r\n  if (errorData.solution_description) {\r\n    formData.append(\"solution_description\", errorData.solution_description);\r\n  }\r\n  if (errorData.files && errorData.files.length > 0) {\r\n    errorData.files.forEach((file) => {\r\n      formData.append(\"files\", file);\r\n    });\r\n  }\r\n\r\n  const response = await fetch(url.toString(), {\r\n    method: \"POST\",\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to create error\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function updateError(errorId, errorData) {\r\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}`, {\r\n    method: \"PUT\",\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: JSON.stringify(errorData),\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to update error\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\nexport async function deleteError(errorId) {\r\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}`, {\r\n    method: \"DELETE\",\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to delete error\");\r\n  }\r\n  return true;\r\n}\r\n\r\nexport async function uploadErrorImage(errorId, file) {\r\n  const formData = new FormData();\r\n  formData.append(\"file\", file);\r\n\r\n  const response = await fetch(`${API_BASE_URL}/errors/${errorId}/images/`, {\r\n    method: \"POST\",\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n    body: formData,\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to upload error image\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\n// New function to fetch contact infos with local_kw=1\r\nexport async function fetchContactInfos() {\r\n  const url = new URL(`${API_BASE_URL}/contact_info/`);\r\n  url.searchParams.append(\"local_kw\", \"1\");\r\n\r\n  const response = await fetch(url.toString(), {\r\n    headers: {\r\n      ...getAuthHeaders(),\r\n    },\r\n  });\r\n  if (!response.ok) {\r\n    throw new Error(\"Failed to fetch contact infos\");\r\n  }\r\n  return await response.json();\r\n}\r\n\r\n// Add more API client functions as needed for other endpoints\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}