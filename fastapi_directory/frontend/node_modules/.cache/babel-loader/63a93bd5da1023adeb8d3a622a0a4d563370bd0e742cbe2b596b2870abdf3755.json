{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Modal,Box,Typography,TextField,Select,MenuItem,Checkbox,FormControlLabel,Button}from'@mui/material';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const style={position:'absolute',top:'50%',left:'50%',transform:'translate(-50%, -50%)',width:400,bgcolor:'#2a2f4a',borderRadius:2,boxShadow:24,p:4,color:'white'};function CreateUserModal(_ref){let{open,onClose,token,roles,onUserCreated=()=>{}}=_ref;const[username,setUsername]=useState('');const[realname,setRealname]=useState('');const[password,setPassword]=useState('');const[roleId,setRoleId]=useState('');const[isAdmin,setIsAdmin]=useState(false);const[isSuperAdmin,setIsSuperAdmin]=useState(false);const[error,setError]=useState('');useEffect(()=>{if(roles.length>0){setRoleId(roles[0].id);}},[roles]);const handleSubmit=async()=>{if(!username||!realname||!password||!roleId){setError('Все поля обязательны для заполнения');return;}try{await axios.post('/api/users/',{username,realname,password,role_id:roleId,is_admin:isAdmin,is_super_admin:isSuperAdmin},{headers:{Authorization:\"Bearer \".concat(token)}});setError('');onUserCreated();onClose();// Reset form\nsetUsername('');setRealname('');setPassword('');setRoleId(roles.length>0?roles[0].id:'');setIsAdmin(false);setIsSuperAdmin(false);}catch(err){var _err$response,_err$response2,_err$response2$data;console.error('Create user error:',((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.data)||err.message||err);setError(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||'Ошибка при создании пользователя');}};return/*#__PURE__*/_jsx(Modal,{open:open,onClose:onClose,children:/*#__PURE__*/_jsxs(Box,{sx:style,children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",component:\"h2\",sx:{mb:2},children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\"}),error&&/*#__PURE__*/_jsx(Typography,{sx:{color:'#ff6b6b',mb:2,fontWeight:'700'},children:error}),/*#__PURE__*/_jsx(TextField,{label:\"\\u0418\\u043C\\u044F \\u043F\\u043E\\u043B\\u044C\\u0437\\u043E\\u0432\\u0430\\u0442\\u0435\\u043B\\u044F\",value:username,onChange:e=>setUsername(e.target.value),fullWidth:true,sx:{mb:2},InputProps:{sx:{color:'white'}}}),/*#__PURE__*/_jsx(TextField,{label:\"\\u041D\\u0430\\u0441\\u0442\\u043E\\u044F\\u0449\\u0435\\u0435 \\u0438\\u043C\\u044F\",value:realname,onChange:e=>setRealname(e.target.value),fullWidth:true,sx:{mb:2},InputProps:{sx:{color:'white'}}}),/*#__PURE__*/_jsx(TextField,{label:\"\\u041F\\u0430\\u0440\\u043E\\u043B\\u044C\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value),fullWidth:true,sx:{mb:2},InputProps:{sx:{color:'white'}}}),/*#__PURE__*/_jsx(Select,{value:roleId,onChange:e=>setRoleId(e.target.value),fullWidth:true,sx:{mb:2,color:'white'},children:roles.map(role=>/*#__PURE__*/_jsx(MenuItem,{value:role.id,children:role.name},role.id))}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:isAdmin,onChange:e=>setIsAdmin(e.target.checked),sx:{color:'#f2a365','&.Mui-checked':{color:'#f2a365'}}}),label:\"\\u0410\\u0434\\u043C\\u0438\\u043D\",sx:{mb:1}}),/*#__PURE__*/_jsx(FormControlLabel,{control:/*#__PURE__*/_jsx(Checkbox,{checked:isSuperAdmin,onChange:e=>setIsSuperAdmin(e.target.checked),sx:{color:'#f2a365','&.Mui-checked':{color:'#f2a365'}}}),label:\"\\u0421\\u0443\\u043F\\u0435\\u0440 \\u0430\\u0434\\u043C\\u0438\\u043D\",sx:{mb:2}}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'flex-end'},children:/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleSubmit,sx:{backgroundColor:'#f2a365',color:'#2a2f4a',fontWeight:'700'},children:\"\\u0421\\u043E\\u0437\\u0434\\u0430\\u0442\\u044C\"})})]})});}export default CreateUserModal;","map":{"version":3,"names":["React","useState","useEffect","Modal","Box","Typography","TextField","Select","MenuItem","Checkbox","FormControlLabel","Button","axios","jsx","_jsx","jsxs","_jsxs","style","position","top","left","transform","width","bgcolor","borderRadius","boxShadow","p","color","CreateUserModal","_ref","open","onClose","token","roles","onUserCreated","username","setUsername","realname","setRealname","password","setPassword","roleId","setRoleId","isAdmin","setIsAdmin","isSuperAdmin","setIsSuperAdmin","error","setError","length","id","handleSubmit","post","role_id","is_admin","is_super_admin","headers","Authorization","concat","err","_err$response","_err$response2","_err$response2$data","console","response","data","message","detail","children","sx","variant","component","mb","fontWeight","label","value","onChange","e","target","fullWidth","InputProps","type","map","role","name","control","checked","display","justifyContent","onClick","backgroundColor"],"sources":["F:/Progect/Errors/fastapi_directory/frontend/src/components/CreateUserModal.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Modal,\r\n  Box,\r\n  Typography,\r\n  TextField,\r\n  Select,\r\n  MenuItem,\r\n  Checkbox,\r\n  FormControlLabel,\r\n  Button,\r\n} from '@mui/material';\r\nimport axios from 'axios';\r\n\r\nconst style = {\r\n  position: 'absolute',\r\n  top: '50%',\r\n  left: '50%',\r\n  transform: 'translate(-50%, -50%)',\r\n  width: 400,\r\n  bgcolor: '#2a2f4a',\r\n  borderRadius: 2,\r\n  boxShadow: 24,\r\n  p: 4,\r\n  color: 'white',\r\n};\r\n\r\nfunction CreateUserModal({ open, onClose, token, roles, onUserCreated = () => {} }) {\r\n  const [username, setUsername] = useState('');\r\n  const [realname, setRealname] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [roleId, setRoleId] = useState('');\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n  const [isSuperAdmin, setIsSuperAdmin] = useState(false);\r\n  const [error, setError] = useState('');\r\n\r\n  useEffect(() => {\r\n    if (roles.length > 0) {\r\n      setRoleId(roles[0].id);\r\n    }\r\n  }, [roles]);\r\n\r\n  const handleSubmit = async () => {\r\n    if (!username || !realname || !password || !roleId) {\r\n      setError('Все поля обязательны для заполнения');\r\n      return;\r\n    }\r\n    try {\r\n      await axios.post(\r\n        '/api/users/',\r\n        {\r\n          username,\r\n          realname,\r\n          password,\r\n          role_id: roleId,\r\n          is_admin: isAdmin,\r\n          is_super_admin: isSuperAdmin,\r\n        },\r\n        {\r\n          headers: { Authorization: `Bearer ${token}` },\r\n        }\r\n      );\r\n      setError('');\r\n      onUserCreated();\r\n      onClose();\r\n      // Reset form\r\n      setUsername('');\r\n      setRealname('');\r\n      setPassword('');\r\n      setRoleId(roles.length > 0 ? roles[0].id : '');\r\n      setIsAdmin(false);\r\n      setIsSuperAdmin(false);\r\n    } catch (err) {\r\n      console.error('Create user error:', err.response?.data || err.message || err);\r\n      setError(err.response?.data?.detail || 'Ошибка при создании пользователя');\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Modal open={open} onClose={onClose}>\r\n      <Box sx={style}>\r\n        <Typography variant=\"h6\" component=\"h2\" sx={{ mb: 2 }}>\r\n          Создать пользователя\r\n        </Typography>\r\n        {error && (\r\n          <Typography sx={{ color: '#ff6b6b', mb: 2, fontWeight: '700' }}>\r\n            {error}\r\n          </Typography>\r\n        )}\r\n        <TextField\r\n          label=\"Имя пользователя\"\r\n          value={username}\r\n          onChange={(e) => setUsername(e.target.value)}\r\n          fullWidth\r\n          sx={{ mb: 2 }}\r\n          InputProps={{ sx: { color: 'white' } }}\r\n        />\r\n        <TextField\r\n          label=\"Настоящее имя\"\r\n          value={realname}\r\n          onChange={(e) => setRealname(e.target.value)}\r\n          fullWidth\r\n          sx={{ mb: 2 }}\r\n          InputProps={{ sx: { color: 'white' } }}\r\n        />\r\n        <TextField\r\n          label=\"Пароль\"\r\n          type=\"password\"\r\n          value={password}\r\n          onChange={(e) => setPassword(e.target.value)}\r\n          fullWidth\r\n          sx={{ mb: 2 }}\r\n          InputProps={{ sx: { color: 'white' } }}\r\n        />\r\n        <Select\r\n          value={roleId}\r\n          onChange={(e) => setRoleId(e.target.value)}\r\n          fullWidth\r\n          sx={{ mb: 2, color: 'white' }}\r\n        >\r\n          {roles.map((role) => (\r\n            <MenuItem key={role.id} value={role.id}>\r\n              {role.name}\r\n            </MenuItem>\r\n          ))}\r\n        </Select>\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox\r\n              checked={isAdmin}\r\n              onChange={(e) => setIsAdmin(e.target.checked)}\r\n              sx={{ color: '#f2a365', '&.Mui-checked': { color: '#f2a365' } }}\r\n            />\r\n          }\r\n          label=\"Админ\"\r\n          sx={{ mb: 1 }}\r\n        />\r\n        <FormControlLabel\r\n          control={\r\n            <Checkbox\r\n              checked={isSuperAdmin}\r\n              onChange={(e) => setIsSuperAdmin(e.target.checked)}\r\n              sx={{ color: '#f2a365', '&.Mui-checked': { color: '#f2a365' } }}\r\n            />\r\n          }\r\n          label=\"Супер админ\"\r\n          sx={{ mb: 2 }}\r\n        />\r\n        <Box sx={{ display: 'flex', justifyContent: 'flex-end' }}>\r\n          <Button\r\n            variant=\"contained\"\r\n            onClick={handleSubmit}\r\n            sx={{ backgroundColor: '#f2a365', color: '#2a2f4a', fontWeight: '700' }}\r\n          >\r\n            Создать\r\n          </Button>\r\n        </Box>\r\n      </Box>\r\n    </Modal>\r\n  );\r\n}\r\n\r\nexport default CreateUserModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}