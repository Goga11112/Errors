{"ast":null,"code":"import React,{useEffect,useState}from'react';import axios from'axios';import{Typography,CircularProgress,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,Paper,TablePagination}from'@mui/material';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AdminPanelLogs(_ref){let{token}=_ref;const[logs,setLogs]=useState([]);const[error,setError]=useState('');const[loading,setLoading]=useState(false);const[page,setPage]=useState(0);const[rowsPerPage,setRowsPerPage]=useState(10);const[totalCount,setTotalCount]=useState(0);useEffect(()=>{const fetchLogs=async()=>{setLoading(true);try{const response=await axios.get(\"\".concat(process.env.REACT_APP_API_BASE_URL||'/api',\"/admin_logs/\"),{headers:{Authorization:\"Bearer \".concat(token)},params:{skip:page*rowsPerPage,limit:rowsPerPage}});setLogs(response.data);setTotalCount(1000);// Set a large number or implement total count from backend if available\nsetError('');}catch(err){const errorMessage=err.response&&err.response.data&&err.response.data.detail?JSON.stringify(err.response.data.detail):err.message;console.log(\"Error message:\",errorMessage);setError('Ошибка при загрузке логов: '+errorMessage);}finally{setLoading(false);}};fetchLogs();},[token,page,rowsPerPage]);const handleChangePage=(event,newPage)=>{setPage(newPage);};const handleChangeRowsPerPage=event=>{setRowsPerPage(parseInt(event.target.value,10));setPage(0);};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",gutterBottom:true,sx:{color:'#f2a365'},children:\"\\u041B\\u043E\\u0433\\u0438 \\u0430\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440\\u043E\\u0432\"}),loading?/*#__PURE__*/_jsx(CircularProgress,{sx:{color:'#f2a365'}}):error?/*#__PURE__*/_jsx(Typography,{sx:{color:'#ff6b6b',fontWeight:'700'},children:error}):/*#__PURE__*/_jsxs(TableContainer,{component:Paper,sx:{backgroundColor:'#2a2f4a',color:'#eaeaea'},children:[/*#__PURE__*/_jsxs(Table,{\"aria-label\":\"admin logs table\",sx:{color:'#eaeaea'},children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"ID \\u043B\\u043E\\u0433\\u0430\"}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"\\u0410\\u0434\\u043C\\u0438\\u043D\\u0438\\u0441\\u0442\\u0440\\u0430\\u0442\\u043E\\u0440 \\u0432\\u044B\\u043F\\u043E\\u043B\\u043D\\u0438\\u0432\\u0448\\u0438\\u0439 \\u0434\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435\"}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"\\u0414\\u0435\\u0439\\u0441\\u0442\\u0432\\u0438\\u0435\"}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"IP \\u0430\\u0434\\u0440\\u0435\\u0441\"}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"\\u0418\\u0441\\u043F\\u043E\\u043B\\u044C\\u0437\\u0443\\u0435\\u043C\\u043E\\u0435 \\u043F\\u0440\\u0438\\u043B\\u043E\\u0436\\u0435\\u043D\\u0438\\u0435\"}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#f2a365'},children:\"\\u0414\\u0430\\u0442\\u0430\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:logs.map(log=>/*#__PURE__*/_jsxs(TableRow,{sx:{color:'#eaeaea'},children:[/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:log.id}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:log.admin_id}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:log.action}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:log.ip_address||'-'}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:log.user_agent||'-'}),/*#__PURE__*/_jsx(TableCell,{sx:{color:'#eaeaea'},children:new Date(log.timestamp).toLocaleString()})]},log.id))})]}),/*#__PURE__*/_jsx(TablePagination,{component:\"div\",count:totalCount,page:page,onPageChange:handleChangePage,rowsPerPage:rowsPerPage,onRowsPerPageChange:handleChangeRowsPerPage,rowsPerPageOptions:[5,10,25],sx:{color:'#eaeaea',backgroundColor:'#2a2f4a','.MuiTablePagination-selectLabel, .MuiTablePagination-displayedRows':{color:'#f2a365'},'.MuiTablePagination-select':{color:'#f2a365'},'.MuiSvgIcon-root':{color:'#f2a365'},'.MuiTablePagination-actions button':{color:'#f2a365'}}})]})]});}export default AdminPanelLogs;","map":{"version":3,"names":["React","useEffect","useState","axios","Typography","CircularProgress","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","Paper","TablePagination","jsx","_jsx","jsxs","_jsxs","AdminPanelLogs","_ref","token","logs","setLogs","error","setError","loading","setLoading","page","setPage","rowsPerPage","setRowsPerPage","totalCount","setTotalCount","fetchLogs","response","get","concat","process","env","REACT_APP_API_BASE_URL","headers","Authorization","params","skip","limit","data","err","errorMessage","detail","JSON","stringify","message","console","log","handleChangePage","event","newPage","handleChangeRowsPerPage","parseInt","target","value","children","variant","gutterBottom","sx","color","fontWeight","component","backgroundColor","map","id","admin_id","action","ip_address","user_agent","Date","timestamp","toLocaleString","count","onPageChange","onRowsPerPageChange","rowsPerPageOptions"],"sources":["C:/Project/Errors/fastapi_directory/frontend/src/components/AdminPanelLogs.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport axios from 'axios';\r\nimport { Typography, CircularProgress, Table, TableBody, TableCell, TableContainer, TableHead, TableRow, Paper, TablePagination } from '@mui/material';\r\n\r\nfunction AdminPanelLogs({ token }) {\r\n  const [logs, setLogs] = useState([]);\r\n  const [error, setError] = useState('');\r\n  const [loading, setLoading] = useState(false);\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(10);\r\n  const [totalCount, setTotalCount] = useState(0);\r\n\r\n  useEffect(() => {\r\n    const fetchLogs = async () => {\r\n      setLoading(true);\r\n      try {\r\n       \r\n        const response = await axios.get(`${process.env.REACT_APP_API_BASE_URL || '/api'}/admin_logs/`, {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n          },\r\n          params: {\r\n            skip: page * rowsPerPage,\r\n            limit: rowsPerPage\r\n          },\r\n        });\r\n        setLogs(response.data);\r\n        setTotalCount(1000); // Set a large number or implement total count from backend if available\r\n        setError('');\r\n      } catch (err) {\r\n        const errorMessage = err.response && err.response.data && err.response.data.detail\r\n          ? JSON.stringify(err.response.data.detail)\r\n          : err.message;\r\n        console.log(\"Error message:\", errorMessage);\r\n        setError('Ошибка при загрузке логов: ' + errorMessage);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchLogs();\r\n  }, [token, page, rowsPerPage]);\r\n\r\n  const handleChangePage = (event, newPage) => {\r\n    setPage(newPage);\r\n  };\r\n\r\n  const handleChangeRowsPerPage = (event) => {\r\n    setRowsPerPage(parseInt(event.target.value, 10));\r\n    setPage(0);\r\n  };\r\n\r\n  return (\r\n    <div>\r\n      <Typography variant=\"h4\" gutterBottom sx={{ color: '#f2a365' }}>\r\n        Логи администраторов\r\n      </Typography>\r\n      {loading ? (\r\n        <CircularProgress sx={{ color: '#f2a365' }} />\r\n      ) : error ? (\r\n        <Typography sx={{ color: '#ff6b6b', fontWeight: '700' }}>{error}</Typography>\r\n      ) : (\r\n        <TableContainer component={Paper} sx={{ backgroundColor: '#2a2f4a', color: '#eaeaea' }}>\r\n          <Table aria-label=\"admin logs table\" sx={{ color: '#eaeaea' }}>\r\n            <TableHead>\r\n              <TableRow>\r\n                <TableCell sx={{ color: '#f2a365' }}>ID лога</TableCell>\r\n                <TableCell sx={{ color: '#f2a365' }}>Администратор выполнивший действие</TableCell>\r\n                <TableCell sx={{ color: '#f2a365' }}>Действие</TableCell>\r\n                <TableCell sx={{ color: '#f2a365' }}>IP адрес</TableCell>\r\n                <TableCell sx={{ color: '#f2a365' }}>Используемое приложение</TableCell>\r\n                <TableCell sx={{ color: '#f2a365' }}>Дата</TableCell>\r\n              </TableRow>\r\n            </TableHead>\r\n            <TableBody>\r\n              {logs.map((log) => (\r\n                <TableRow key={log.id} sx={{ color: '#eaeaea' }}>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{log.id}</TableCell>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{log.admin_id}</TableCell>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{log.action}</TableCell>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{log.ip_address || '-'}</TableCell>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{log.user_agent || '-'}</TableCell>\r\n                  <TableCell sx={{ color: '#eaeaea' }}>{new Date(log.timestamp).toLocaleString()}</TableCell>\r\n                </TableRow>\r\n              ))}\r\n            </TableBody>\r\n          </Table>\r\n          <TablePagination\r\n            component=\"div\"\r\n            count={totalCount}\r\n            page={page}\r\n            onPageChange={handleChangePage}\r\n            rowsPerPage={rowsPerPage}\r\n            onRowsPerPageChange={handleChangeRowsPerPage}\r\n            rowsPerPageOptions={[5, 10, 25]}\r\n            sx={{\r\n              color: '#eaeaea',\r\n              backgroundColor: '#2a2f4a',\r\n              '.MuiTablePagination-selectLabel, .MuiTablePagination-displayedRows': {\r\n                color: '#f2a365',\r\n              },\r\n              '.MuiTablePagination-select': {\r\n                color: '#f2a365',\r\n              },\r\n              '.MuiSvgIcon-root': {\r\n                color: '#f2a365',\r\n              },\r\n              '.MuiTablePagination-actions button': {\r\n                color: '#f2a365',\r\n              },\r\n            }}\r\n          />\r\n        </TableContainer>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AdminPanelLogs;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}